"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("react");function t(){return t=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n])}return r},t.apply(this,arguments)}function e(r,t){if(null==r)return{};var e,n,o=function(r,t){if(null==r)return{};var e={};for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(t.indexOf(n)>=0)continue;e[n]=r[n]}return e}(r,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)e=i[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(r,e)&&(o[e]=r[e])}return o}function n(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var n,o,i,u,c=[],a=!0,l=!1;try{if(i=(e=e.call(r)).next,0===t);else for(;!(a=(n=i.call(e)).done)&&(c.push(n.value),c.length!==t);a=!0);}catch(r){l=!0,o=r}finally{try{if(!a&&null!=e.return&&(u=e.return(),Object(u)!==u))return}finally{if(l)throw o}}return c}}(r,t)||function(r,t){if(!r)return;if("string"==typeof r)return o(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);"Object"===e&&r.constructor&&(e=r.constructor.name);if("Map"===e||"Set"===e)return Array.from(r);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return o(r,t)}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}var i=["children","onVisibilityChange","onEntryUpdate","root","rootMargin","threshold"];exports.default=function(o){var u=o.children,c=o.onVisibilityChange,a=o.onEntryUpdate,l=o.root,f=void 0===l?null:l,s=o.rootMargin,y=void 0===s?"0px":s,v=o.threshold,b=void 0===v?.1:v,p=e(o,i),h=r.useRef(null),d=n(r.useState(null),2),g=d[0],O=d[1],m=r.useCallback((function(r,t){a&&a(r,t),r!==g&&(O(r),c&&c(r,t))}),[a,c,g]);return r.useEffect((function(){var r=new IntersectionObserver((function(r){r.forEach((function(r){m(r.isIntersecting,r)}))}),{root:f,rootMargin:y,threshold:b}),t=h.current;return t&&r.observe(t),function(){t&&r.unobserve(t),r.disconnect()}}),[f,y,b,m]),r.createElement("div",t({ref:h},p),u)},exports.useIntersectionObserver=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{root:null,rootMargin:"0px",threshold:.1},i=r.useRef(null),u=r.useRef(new Map);return r.useEffect((function(){i.current=new IntersectionObserver((function(r){r.forEach((function(r){n&&n(r);var t=u.current.get(r.target),o=r.isIntersecting;t!==o&&(u.current.set(r.target,o),e&&e(o,r))}))}),o);var r=t.current;return r&&(Array.isArray(r)?r.forEach((function(r){return i.current.observe(r)})):i.current.observe(r)),function(){i.current&&i.current.disconnect()}}),[t,e,n,o]),i};
